---
description: Use these rules when working with database operations, migrations, or schema changes in the project. It provides guidance on PostgreSQL and Drizzle ORM usage, including database structure, migration management, best practices, and connection configuration. The rule is essential for understanding how to properly handle database models, generate and apply migrations, maintain type safety, and configure database connections through environment variables.
globs: 
alwaysApply: false
---
# Database Guide

This project uses PostgreSQL with Drizzle ORM for database management.

## Database Structure

- Database models are defined in [schema.ts](mdc:src/spi/repositories/database/schema.ts)
- Migrations are managed and applied through Drizzle Kit
- Database configuration is in [drizzle.config.ts](mdc:drizzle.config.ts)

## Working with Migrations

### Generate migrations:
   
```bash
nvm install && npm run db:generate
```

## Database Best Practices

1. Never directly create, modify, or apply migration files in `src/spi/repositories/database/migrations/*`
2. Migrations are automatically generated after [schema.ts](mdc:src/spi/repositories/database/schema.ts) changes (and its dependencies) are made and the following command is ran: `nvm install && npm run db:migrate`

## Database Connection

The database connection is managed through the SPI layer and configured via environment variables:
- `DATABASE_URL` - PostgreSQL connection string

